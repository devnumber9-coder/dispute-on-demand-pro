<!DOCTYPE html>
<html lang="en" x-data="app()" x-init="init()" :class="{ 'dark': darkMode }">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dispute On Demand - Modern Credit Dispute Generator</title>
    
    <!-- Alpine.js for Reactivity -->
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- PDF Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: '#4a90e2',
                        'primary-dark': '#357abd'
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-gray-50 dark:bg-gray-900 transition-colors duration-300">
    
    <!-- Main App Container -->
    <div class="min-h-screen">
        
        <!-- Header -->
        <header class="bg-white dark:bg-gray-800 shadow-sm">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
                <div class="flex justify-between items-center">
                    <div>
                        <h1 class="text-2xl font-bold text-gray-900 dark:text-white flex items-center gap-2">
                            üí≥ Dispute On Demand
                        </h1>
                        <p class="text-sm text-gray-600 dark:text-gray-400">FCRA-Compliant Credit Dispute Generator</p>
                    </div>
                    <button @click="darkMode = !darkMode" 
                            class="px-4 py-2 rounded-lg bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 transition">
                        <span x-show="!darkMode">üåô Dark</span>
                        <span x-show="darkMode">‚òÄÔ∏è Light</span>
                    </button>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
            
            <!-- Progress Steps -->
            <div class="mb-8">
                <div class="flex items-center justify-between">
                    <template x-for="(step, index) in steps" :key="index">
                        <div class="flex-1 flex flex-col items-center relative">
                            <div :class="currentStep >= index + 1 ? 'bg-primary text-white' : 'bg-gray-300 dark:bg-gray-700 text-gray-600 dark:text-gray-400'"
                                 class="w-10 h-10 rounded-full flex items-center justify-center font-bold z-10">
                                <span x-text="index + 1"></span>
                            </div>
                            <p class="text-xs mt-2 text-gray-600 dark:text-gray-400" x-text="step.label"></p>
                            <div x-show="index < steps.length - 1" 
                                 class="absolute top-5 left-1/2 w-full h-0.5 bg-gray-300 dark:bg-gray-700 -z-10"></div>
                        </div>
                    </template>
                </div>
            </div>

            <!-- Step 1: User Information -->
            <div x-show="currentStep === 1" class="bg-white dark:bg-gray-800 rounded-lg shadow p-6 mb-6">
                <h2 class="text-xl font-bold mb-4 text-gray-900 dark:text-white">Your Information</h2>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium mb-2 text-gray-700 dark:text-gray-300">Full Name *</label>
                        <input x-model="userData.name" type="text" 
                               class="w-full px-4 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-2 text-gray-700 dark:text-gray-300">Address *</label>
                        <input x-model="userData.address" type="text" 
                               class="w-full px-4 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-2 text-gray-700 dark:text-gray-300">City, State, ZIP *</label>
                        <input x-model="userData.city" type="text" 
                               class="w-full px-4 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-2 text-gray-700 dark:text-gray-300">State *</label>
                        <select x-model="userData.state" 
                                class="w-full px-4 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                            <option value="">Select...</option>
                            <option value="CA">California</option>
                            <option value="NY">New York</option>
                            <option value="TX">Texas</option>
                            <option value="FL">Florida</option>
                            <!-- Add all states -->
                        </select>
                    </div>
                </div>

                <button @click="nextStep()" 
                        class="mt-6 px-6 py-3 bg-primary text-white rounded-lg hover:bg-primary-dark transition">
                    Continue ‚Üí
                </button>
            </div>

            <!-- Step 2: Upload/Parse Report -->
            <div x-show="currentStep === 2" class="bg-white dark:bg-gray-800 rounded-lg shadow p-6 mb-6">
                <h2 class="text-xl font-bold mb-4 text-gray-900 dark:text-white">Upload Credit Report</h2>
                
                <div class="border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-8 text-center">
                    <input @change="handleFileUpload" type="file" accept=".pdf,.txt" class="hidden" id="fileUpload">
                    <label for="fileUpload" class="cursor-pointer">
                        <div class="text-4xl mb-2">üìÑ</div>
                        <p class="text-gray-600 dark:text-gray-400">Click to upload or drag & drop</p>
                        <p class="text-sm text-gray-500">PDF or Text files only</p>
                    </label>
                </div>

                <div class="mt-6">
                    <p class="text-sm font-medium mb-2 text-gray-700 dark:text-gray-300">Or paste text:</p>
                    <textarea x-model="pastedText" rows="6" @input="parseText()"
                              class="w-full px-4 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white font-mono text-sm"
                              placeholder="Paste your credit report text here..."></textarea>
                </div>

                <div class="flex gap-4 mt-6">
                    <button @click="prevStep()" class="px-6 py-3 bg-gray-300 dark:bg-gray-700 rounded-lg">‚Üê Back</button>
                    <button @click="nextStep()" class="px-6 py-3 bg-primary text-white rounded-lg hover:bg-primary-dark">Continue ‚Üí</button>
                </div>
            </div>

            <!-- Step 3: Select Disputes -->
            <div x-show="currentStep === 3" class="bg-white dark:bg-gray-800 rounded-lg shadow p-6 mb-6">
                <h2 class="text-xl font-bold mb-4 text-gray-900 dark:text-white">Select Disputes</h2>
                
                <div class="space-y-4">
                    <template x-for="(dispute, index) in disputes" :key="index">
                        <div class="border dark:border-gray-700 rounded-lg p-4 flex items-center gap-4">
                            <input type="checkbox" x-model="dispute.selected" class="w-5 h-5">
                            <div class="flex-1">
                                <p class="font-semibold text-gray-900 dark:text-white" x-text="dispute.name"></p>
                                <p class="text-sm text-gray-600 dark:text-gray-400" x-text="'Account: ' + dispute.account"></p>
                            </div>
                        </div>
                    </template>
                </div>

                <button @click="addManualDispute()" class="mt-4 px-4 py-2 bg-green-500 text-white rounded-lg">+ Add Manual</button>

                <div class="flex gap-4 mt-6">
                    <button @click="prevStep()" class="px-6 py-3 bg-gray-300 dark:bg-gray-700 rounded-lg">‚Üê Back</button>
                    <button @click="generateLetters()" class="px-6 py-3 bg-primary text-white rounded-lg hover:bg-primary-dark">Generate Letters ‚Üí</button>
                </div>
            </div>

            <!-- Step 4: Download Letters -->
            <div x-show="currentStep === 4" class="bg-white dark:bg-gray-800 rounded-lg shadow p-6 mb-6">
                <h2 class="text-xl font-bold mb-4 text-gray-900 dark:text-white">Your Dispute Letters</h2>
                
                <div class="space-y-6">
                    <template x-for="bureau in ['Equifax', 'Experian', 'TransUnion']" :key="bureau">
                        <div class="border dark:border-gray-700 rounded-lg p-4">
                            <h3 class="font-bold mb-2 text-gray-900 dark:text-white" x-text="bureau"></h3>
                            <pre class="bg-gray-100 dark:bg-gray-900 p-4 rounded text-sm overflow-auto" x-text="letters[bureau]"></pre>
                            <button @click="downloadPDF(bureau)" class="mt-4 px-4 py-2 bg-primary text-white rounded-lg">Download PDF</button>
                        </div>
                    </template>
                </div>

                <button @click="reset()" class="mt-6 px-6 py-3 bg-gray-300 dark:bg-gray-700 rounded-lg">Start Over</button>
            </div>

        </main>
    </div>

    <script>
        function app() {
            return {
                darkMode: false,
                currentStep: 1,
                steps: [
                    { label: 'Your Info' },
                    { label: 'Upload Report' },
                    { label: 'Select Disputes' },
                    { label: 'Download' }
                ],
                userData: {
                    name: '',
                    address: '',
                    city: '',
                    state: ''
                },
                pastedText: '',
                disputes: [],
                letters: {},

                init() {
                    this.darkMode = localStorage.getItem('darkMode') === 'true';
                    this.$watch('darkMode', value => localStorage.setItem('darkMode', value));
                },

                nextStep() {
                    if (this.currentStep < 4) this.currentStep++;
                },

                prevStep() {
                    if (this.currentStep > 1) this.currentStep--;
                },

                async handleFileUpload(event) {
                    const file = event.target.files[0];
                    if (!file) return;

                    if (file.type === 'application/pdf') {
                        // PDF parsing logic here
                        alert('PDF parsing coming soon!');
                    } else {
                        const text = await file.text();
                        this.pastedText = text;
                        this.parseText();
                    }
                },

                parseText() {
                    // Simple parsing logic
                    const lines = this.pastedText.split('\n');
                    const found = [];
                    
                    lines.forEach((line, i) => {
                        if (line.match(/account|creditor/i) && lines[i+1]) {
                            found.push({
                                name: line.trim(),
                                account: lines[i+1].trim(),
                                selected: false
                            });
                        }
                    });

                    this.disputes = found;
                },

                addManualDispute() {
                    const name = prompt('Creditor name:');
                    const account = prompt('Account number:');
                    if (name && account) {
                        this.disputes.push({ name, account, selected: true });
                    }
                },

                generateLetters() {
                    const selected = this.disputes.filter(d => d.selected);
                    if (selected.length === 0) {
                        alert('Please select at least one dispute');
                        return;
                    }

                    const bureaus = ['Equifax', 'Experian', 'TransUnion'];
                    bureaus.forEach(bureau => {
                        this.letters[bureau] = this.createLetter(bureau, selected);
                    });

                    this.currentStep = 4;
                },

                                createLetter(bureau, disputes) {
                    const today = new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });
                    let items = '';
                    disputes.forEach((d, i) => {
                        items += `\n${i+1}. ${d.name}\n   Account: ${d.account}\n   Reason: Inaccurate information\n`;
                    });

                    return `${this.userData.name}
${this.userData.address}
${this.userData.city}

${today}

${bureau} Credit Bureau
[Bureau Address]

Re: Request for Investigation of Inaccurate Credit Information

Dear Sir/Madam,

I am writing to dispute inaccurate information appearing on my credit report. Under the Fair Credit Reporting Act (FCRA) 15 U.S.C. ¬ß 1681, I have the right to request that you investigate and correct any inaccurate, incomplete, or unverifiable information in my credit file.

The following items on my credit report are inaccurate:
${items}

Under FCRA ¬ß 611(a)(1)(A), you are required to conduct a reasonable investigation of my dispute within 30 days of receiving this letter. If you cannot verify the accuracy of this information, you must delete it from my credit file pursuant to FCRA ¬ß 611(a)(5)(A).

I request that you:
1. Conduct a thorough investigation of the items listed above
2. Provide me with written results of your investigation
3. Correct or delete any information found to be inaccurate or unverifiable
4. Provide me with an updated credit report if changes are made

Please send all correspondence to my address listed above.

Thank you for your prompt attention to this matter.

Sincerely,

${this.userData.name}

---
Generated by Dispute On Demand. You have the right to dispute credit report errors for free.`;
                }}
                    },
            downloadLetter(bureau) {
                const element = document.createElement('a');
                const file = new Blob([this.letters[bureau]], {type: 'text/plain'});
                element.href = URL.createObjectURL(file);
                element.download = `${bureau}_Dispute_Letter_${new Date().toISOString().split('T')[0]}.txt`;
                document.body.appendChild(element);
                element.click();
                document.body.removeChild(element);
            },
            downloadAllPDF() {
                const { jsPDF } = window.jspdf;
                const doc = new jsPDF();
                const bureaus = ['Equifax', 'Experian', 'TransUnion'];
                
                bureaus.forEach((bureau, index) => {
                    if (index > 0) doc.addPage();
                    const lines = doc.splitTextToSize(this.letters[bureau], 180);
                    doc.text(lines, 15, 15);
                });
                
                doc.save(`All_Dispute_Letters_${new Date().toISOString().split('T')[0]}.pdf`);
            },
            reset() {
                this.currentStep = 1;
                this.userData = { name: '', address: '', city: '', state: '' };
                this.pastedText = '';
                this.disputes = [];
                this.letters = {};
            }
        }
    }
    </script>
</body>
</html>


